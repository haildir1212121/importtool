<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>iCabbi Trip Import</title>
  <script defer src="./app.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 24px; }
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:end; }
    label { display:block; font-size:12px; opacity:.8; margin-bottom:6px; }
    input, select, button { padding:10px; font-size:14px; }
    button { cursor:pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 18px; }
    th, td { border: 1px solid #ddd; padding: 8px; font-size: 12px; vertical-align: top; }
    th { background: #f5f5f5; text-align:left; }
    .ok { color: #0a7a0a; font-weight: 600; }
    .bad { color: #b00020; font-weight: 600; }
    .muted { opacity: .75; }
    .pill { display:inline-block; padding:2px 8px; border-radius:999px; background:#eee; font-size:12px; }
    .stack { display:flex; flex-direction:column; gap:12px; }
  </style>
</head>
<body>
  <h1>iCabbi Trip Import</h1>
  <p class="muted">Upload your XLS/XLSX, preview rows, then import valid trips into iCabbi.</p>

  <div class="stack">
    <div class="row">
      <div>
        <label>Spreadsheet (XLS/XLSX)</label>
        <input id="file" type="file" accept=".xls,.xlsx" />
      </div>

      <div>
        <label>Service Date (the day these trips occur)</label>
        <input id="serviceDate" type="date" />
      </div>

      <div>
        <label>Timezone (for converting Schedule Time â†’ UTC Z)</label>
        <input id="timezone" type="text" value="America/Los_Angeles" />
      </div>

      <div>
        <button id="btnParse">Preview</button>
      </div>
    </div>

    <div class="row">
      <div><span id="summary" class="pill">No batch loaded</span></div>
      <div style="margin-left:auto; display:flex; gap:10px;">
        <select id="importMode">
          <option value="validOnly">Import valid rows only</option>
          <option value="all">Import all rows (not recommended)</option>
        </select>
        <button id="btnImport" disabled>Import to iCabbi</button>
      </div>
    </div>

    <div id="results"></div>

    <div style="overflow:auto;">
      <table id="table" style="display:none;">
        <thead>
          <tr>
            <th>Row</th>
            <th>External Booking Id</th>
            <th>Client</th>
            <th>Schedule</th>
            <th>ISO (UTC)</th>
            <th>Phone</th>
            <th>Origin</th>
            <th>Destination</th>
            <th>Valid</th>
            <th>Errors</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>
</body>
</html>
